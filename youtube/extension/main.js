function getVideoStream(trackId){return soundbyte.interop.youtube.getVideoStream(trackId)}function getAudioStream(trackId){return soundbyte.interop.youtube.getAudioStream(trackId)}function resolvePlaylistTracks(count,token,parameters){var playlistId=parameters.playlistId,returnItems=new Array,uri="https://www.googleapis.com/youtube/v3/playlistItems?part=id,snippet,contentDetails&maxResults="+count+"&pageToken="+token+"&playlistId="+playlistId+"&key="+clientKey,data=JSON.parse(soundbyte.network.performRequest(uri));return 0==data.items.length?new soundbyte.SourceResponse("No Music","There is no music in this playlist"):(data.items.forEach(function(item){if("youtube#video"==item.kind&&returnItems.push(toSbTrack(item)),"youtube#playlistItem"==item.kind){var t=toSbTrack(item);t.trackId=item.snippet.resourceId.videoId,returnItems.push(t)}}),new soundbyte.SourceResponse(returnItems,data.nextPageToken))}function getTrending(count,token,parameters){var returnItems=new Array,uri="https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails&chart=mostPopular&maxResults="+count+"&videoCategoryId=10&pageToken="+token+"&key="+clientKey,data=JSON.parse(soundbyte.network.performRequest(uri));return 0==data.items.length?new soundbyte.SourceResponse("No results found","There are no trending YouTube videos."):(data.items.forEach(function(item){"youtube#video"==item.kind&&returnItems.push(toSbTrack(item))}),new soundbyte.SourceResponse(returnItems,data.nextPageToken))}function getUserLikes(count,token,parameters){var returnItems=new Array,uri="https://www.googleapis.com/youtube/v3/videos?part=id,snippet,contentDetails&myRating=like&maxResults="+count+"&videoCategoryId=10&pageToken="+token+"&key="+clientKey,data=JSON.parse(soundbyte.network.performRequest(uri));return 0==data.items.length?new soundbyte.SourceResponse("No results found","Like some videos on Youtube to get started"):(data.items.forEach(function(item){"youtube#video"==item.kind&&returnItems.push(toSbTrack(item))}),new soundbyte.SourceResponse(returnItems,data.nextPageToken))}function getUserPlaylists(count,token,parameters){var returnItems=new Array,uri="https://www.googleapis.com/youtube/v3/playlists?part=id,snippet,contentDetails&mine=true&maxResults="+count+"&pageToken="+token+"&key="+clientKey,data=JSON.parse(soundbyte.network.performRequest(uri));return 0==data.items.length?new soundbyte.SourceResponse("No results found","Create some playlists on Youtube to get started"):(data.items.forEach(function(item){"youtube#playlist"==item.kind&&returnItems.push(toSbPlaylist(item))}),new soundbyte.SourceResponse(returnItems,data.nextPageToken))}function getSearchedTracks(count,token,parameters){return handleSearch("video",parameters.query,count,token)}function getSearchedPlaylists(count,token,parameters){return handleSearch("playlist",parameters.query,count,token)}function getSearchedUsers(count,token,parameters){return new soundbyte.SourceResponse("Not Implemented","Not Implemented")}function handleSearch(type,query,count,token){var returnItems=new Array,uri="https://www.googleapis.com/youtube/v3/search?part=id&maxResults="+count+"&pageToken="+token+"&type="+type+"&key="+clientKey+"&q="+query,data=JSON.parse(soundbyte.network.performRequest(uri));if(0==data.items.length)return new soundbyte.SourceResponse("No results found","Could not find any results matching "+query);var idList="";return data.items.forEach(function(item){idList=idList+item.id[type+"Id"]+","}),getExtendedList(type+"s",idList).items.forEach(function(item){if(item.kind=="youtube#"+type)switch(type){case"video":returnItems.push(toSbTrack(item));break;case"playlist":returnItems.push(toSbPlaylist(item))}}),new soundbyte.SourceResponse(returnItems,data.nextPageToken)}function getExtendedList(type,idList){var uri="https://www.googleapis.com/youtube/v3/"+type+"?part=snippet,contentDetails&key="+clientKey+"&id="+idList;return JSON.parse(soundbyte.network.performRequest(uri))}var clientKey="AIzaSyACcC1JE0krWn90rfk5kVpx-Y8qkoqta40";function toSbTrack(item){var user=new soundbyte.User;user.userId=item.snippet.channelId,user.username=item.snippet.channelTitle;var track=new soundbyte.Track;return track.trackId=item.id,track.title=item.snippet.title,track.description=item.snippet.description,track.duration=getDuration(item),track.user=user,track.artworkUrl=getThumbnail(item.snippet.thumbnails),track.isLive=null!=item.snippet.liveBroadcastContent&&"none"!=item.snippet.liveBroadcastContent,track}function toSbUser(item){return new soundbyte.User}function toSbPlaylist(item){var user=new soundbyte.User;user.userId=item.snippet.channelId,user.username=item.snippet.channelTitle;var playlist=new soundbyte.Playlist;return playlist.playlistId=item.id,playlist.title=item.snippet.title,playlist.description=item.snippet.description,playlist.user=user,playlist.artworkUrl=getThumbnail(item.snippet.thumbnails),playlist}function getThumbnail(thumbnails){return null==thumbnails?"https://soundbytemedia.com/images/512x512-logo.png":null!=thumbnails.maxres?thumbnails.maxres.url:null!=thumbnails.high?thumbnails.high.url:null!=thumbnails.medium?thumbnails.medium.url:null!=thumbnails.default?thumbnails.default.url:"https://soundbytemedia.com/images/512x512-logo.png"}function getDuration(item){return null==item.contentDetails?soundbyte.timeFromMilliseconds(0):isEmpty(item.contentDetails.duration)?null==item.contentDetails.endAt?soundbyte.timeFromMilliseconds(0):soundbyte.timeFromMilliseconds(100*item.contentDetails.endAt):void soundbyte.timeFromMilliseconds(100*ytDurationToSeconds(item.contentDetails.duration))}function isEmpty(str){return!str||0===str.length}function ytDurationToSeconds(duration){var match=duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);return match=match.slice(1).map(function(x){if(null!=x)return x.replace(/\D/,"")}),3600*(parseInt(match[0])||0)+60*(parseInt(match[1])||0)+(parseInt(match[2])||0)}